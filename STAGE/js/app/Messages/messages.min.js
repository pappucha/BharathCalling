var MessageApp=angular.module("Messages",[]);MessageApp.controller("MessagesController",["$scope","$http","$compile","$timeout",function(){}]),MessageApp.directive("messages",["$parse","$http","$timeout",function(){return{restrict:"EA",transclude:!0,controller:function($scope){$scope.Active=!1,$scope.unReadCount=0,$scope.Messages=[{ID:1,Title:"Lorem Ipsum Dollar",unRead:!1},{ID:2,Title:"Lorem Ipsum Dollar",unRead:!0},{ID:1,Title:"Lorem Ipsum Dollar",unRead:!0}],$scope.updateCount=function(){$scope.unReadCount=0,$($scope.Messages).each(function(i,msg){msg.unRead&&$scope.unReadCount++})},$scope.toggle=function(){$scope.Active=!$scope.Active}},link:function(scope,elm){angular.element(document).on("click",function(e){$(e.target).is(elm)||$(e.target).is(elm.find("*"))||(scope.Active=!1,scope.$$phase||scope.$apply())})},template:'<a href="" ng-class="{active:Active}" ng-click="toggle($event)" ng-init="updateCount()"><span class="icon fa fa-comments"></span><i class="new-count" ng-show="unReadCount>0">{{unReadCount}}</i></a><div class="popout" ng-show="Active"><div class="head">Messages</div><div class="popout-content"><ul><li ng-repeat="message in Messages" ng-class="{unread:message.unRead}">{{message.Title}}</li></ul></div><div class="foot"><a href="">View All</a></div></div>'}}]);